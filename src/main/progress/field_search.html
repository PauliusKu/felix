
<SCRIPT LANGUAGE="SpeedScript">
    CREATE WIDGET-POOL.
    {src/web2/wrap-cgi.i}       /* standard WebSpeed include */
    {getNameFromPath.i}         /* local function */
    
</SCRIPT>

<script language="speedscript">
    {ttDetails.i}
    define variable cSearch as character no-undo.
    define variable iType as integer no-undo.
    define variable cSystem as character no-undo.
    define variable cTypeCall as character no-undo.
    
    define variable httOut as handle no-undo.
    httOut = temp-table ttDetails:handle.
    
    cSearch = get-field('search').
    iType = integer(get-field('type')).
    cSystem = get-field('systemName').
    
    case iType:
        when 1 then run findProcedure_details.p (input cSearch, output table ttDetails, input cSystem).
        when 3 then run findInclude_details.p (input cSearch, output table ttDetails, input cSystem).
        when 5 then run findIndex_details.p (input cSearch, output table ttDetails, input cSystem).
    end case.
   

    for each ttDetails:
        ttDetails.info = getNameFromPath(ttDetails.info).
    end.
    output-content-type ("application/json":U).
    httOut:write-json("STREAM", "WebStream").
</script>

